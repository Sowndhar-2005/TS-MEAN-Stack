<!-- Background -->
<div
  class="min-vh-100 d-flex align-items-center justify-content-center bg-light p-4 position-relative overflow-hidden"
>
  <!-- Decorative Background -->
  <div
    class="position-absolute top-0 start-0 w-100 h-100"
    style="
      filter: blur(8px);
      opacity: 0.5;
      background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAXaeHYJXIE3G-wpclgdLMg_RH5RA8wmyllN4OnN8pxEHxeV6DqZd1WKeOnrPjLpGrSr_QeF3ok_yDn_SUFvefESoxbrJlBWMv4oRhbrFpeYalf-LEHAHnKixUWd0mSD8Q7eFHZwF0ejHlPdcu51Kw2Q2Go7DBSmu20DOocEpajlg-hHpyW3WOcoPwHjBArUowGuEfaZN5muXpVvWRxTAaYCWGopqDs0UVAsypd_-MNvUQihCCTqRO-sUZHgNoHcWAXrWowAQ4s8_I');
      background-size: cover;
      background-position: center;
    "
  ></div>
  <div class="position-absolute top-0 start-0 w-100 h-100 bg-white opacity-75"></div>

  <!-- Main Card -->
  <div
    class="card shadow-lg border-0 rounded-4 w-100 position-relative z-1"
    style="max-width: 440px"
  >
    <div class="card-body p-4 p-sm-5">
      <!-- Header -->
      <div class="text-center mb-5">
        <div
          class="d-inline-flex align-items-center justify-content-center bg-primary bg-opacity-10 text-primary rounded-4 mb-3"
          style="width: 64px; height: 64px"
        >
          <i class="bi bi-cup-hot-fill fs-3"></i>
        </div>
        <h1 class="h3 fw-bold text-dark mb-1">
          {{ isLoginMode() ? 'Student / Staff Login' : 'Create Account' }}
        </h1>
        <p class="text-muted small">
          {{ isLoginMode() ? 'Log in to order your next meal' : 'Join Campus Canteen today' }}
        </p>
      </div>

      <!-- Error Message -->
      @if (errorMessage()) {
        <div
          class="alert alert-danger d-flex align-items-center gap-2 mb-4 py-2 small rounded-3"
          role="alert"
        >
          <i class="bi bi-exclamation-circle-fill"></i>
          {{ errorMessage() }}
        </div>
      }

      <!-- Login Form -->
      @if (isLoginMode()) {
        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="d-flex flex-column gap-3">
          <!-- Email/RegNo Input -->
          <div>
            <label class="form-label fw-bold text-muted small ms-1">Email / Register Number</label>
            <div class="input-group">
              <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3">
                <i class="bi bi-person"></i>
              </span>
              <input
                type="text"
                class="form-control bg-light border-start-0 py-2.5 rounded-end-3"
                placeholder="Email or Reg No (e.g. 21CSR...)"
                formControlName="identifier"
              />
            </div>
          </div>

          <!-- Password Input -->
          <div>
            <label class="form-label fw-bold text-muted small ms-1">Password</label>
            <div class="input-group">
              <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3">
                <i class="bi bi-lock"></i>
              </span>
              <input
                [type]="showPassword() ? 'text' : 'password'"
                class="form-control bg-light border-start-0 border-end-0 py-2.5"
                placeholder="••••••••"
                formControlName="password"
              />
              <button
                class="btn btn-light border border-start-0 text-muted pe-3 rounded-end-3"
                type="button"
                (click)="togglePassword()"
              >
                <i
                  class="bi"
                  [class.bi-eye]="!showPassword()"
                  [class.bi-eye-slash]="showPassword()"
                ></i>
              </button>
            </div>
            <div class="text-end mt-2">
              <a href="javascript:void(0)" class="text-decoration-none small text-primary fw-bold"
                >Forgot Password?</a
              >
            </div>
          </div>

          <button
            type="submit"
            class="btn btn-primary w-100 py-3 rounded-3 fw-bold mt-2 shadow-sm"
            [disabled]="loginForm.invalid"
          >
            Login to Canteen
          </button>
        </form>
      } @else {
        <!-- Register Form -->
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="d-flex flex-column gap-3">
          <!-- User Type Toggle -->
          <div class="bg-light p-1 rounded-3 d-flex mb-2">
            <label class="flex-fill cursor-pointer">
              <input type="radio" class="btn-check" formControlName="userType" value="dayscholar" />
              <span
                class="btn btn-sm w-100 fw-bold border-0 rounded-3 py-2"
                [class.bg-white]="registerForm.get('userType')?.value === 'dayscholar'"
                [class.text-primary]="registerForm.get('userType')?.value === 'dayscholar'"
                [class.shadow-sm]="registerForm.get('userType')?.value === 'dayscholar'"
              >
                <i class="bi bi-mortarboard-fill me-1"></i> Day Scholar
              </span>
            </label>
            <label class="flex-fill cursor-pointer">
              <input type="radio" class="btn-check" formControlName="userType" value="hosteller" />
              <span
                class="btn btn-sm w-100 fw-bold border-0 rounded-3 py-2"
                [class.bg-white]="registerForm.get('userType')?.value === 'hosteller'"
                [class.text-primary]="registerForm.get('userType')?.value === 'hosteller'"
                [class.shadow-sm]="registerForm.get('userType')?.value === 'hosteller'"
              >
                <i class="bi bi-house-heart-fill me-1"></i> Hosteller
              </span>
            </label>
          </div>

          <!-- Name -->
          <div>
            <label class="form-label fw-bold text-muted small ms-1">Full Name</label>
            <div class="input-group">
              <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3"
                ><i class="bi bi-person"></i
              ></span>
              <input
                type="text"
                class="form-control bg-light border-start-0 py-2.5 rounded-end-3"
                placeholder="Enter Full Name"
                formControlName="name"
              />
            </div>
          </div>

          <!-- Email -->
          <div>
            <label class="form-label fw-bold text-muted small ms-1">Email Address</label>
            <div class="input-group">
              <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3"
                ><i class="bi bi-envelope"></i
              ></span>
              <input
                type="email"
                class="form-control bg-light border-start-0 py-2.5 rounded-end-3"
                placeholder="student@gmail.com"
                formControlName="email"
              />
            </div>
          </div>

          <!-- Reg No Input -->
          <div>
            <label class="form-label fw-bold text-muted small ms-1">Register Number</label>
            <div class="input-group">
              <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3">
                <i class="bi bi-person-badge"></i>
              </span>
              <input
                type="text"
                class="form-control bg-light border-start-0 py-2.5 rounded-end-3 text-uppercase"
                placeholder="e.g. 21CSR205"
                formControlName="registrationNumber"
              />
            </div>
          </div>

          <!-- Password -->
          <div>
            <label class="form-label fw-bold text-muted small ms-1">Password</label>
            <div class="input-group">
              <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3"
                ><i class="bi bi-lock"></i
              ></span>
              <input
                [type]="showPassword() ? 'text' : 'password'"
                class="form-control bg-light border-start-0 border-end-0 py-2.5"
                placeholder="Min 6 chars"
                formControlName="password"
              />
              <button
                class="btn btn-light border border-start-0 text-muted pe-3 rounded-end-3"
                type="button"
                (click)="togglePassword()"
              >
                <i
                  class="bi"
                  [class.bi-eye]="!showPassword()"
                  [class.bi-eye-slash]="showPassword()"
                ></i>
              </button>
            </div>
          </div>

          <!-- Dept/Year -->
          <div class="row g-2">
             <div class="col-8">
                 <label class="form-label fw-bold text-muted small ms-1">Department</label>
                 <div class="input-group">
                    <span class="input-group-text bg-light border-end-0 text-muted ps-3 rounded-start-3"><i class="bi bi-diagram-3"></i></span>
                    <select class="form-select bg-light border-start-0 py-2.5 rounded-end-3" formControlName="department">
                        <option value="" disabled selected>Select Department</option>
                        @for (dept of departments; track dept) {
                            <option [value]="dept">{{ dept }}</option>
                        }
                    </select>
                 </div>
             </div>
             <div class="col-4">
                 <label class="form-label fw-bold text-muted small ms-1">Year</label>
                 <select class="form-select bg-light py-2.5 rounded-3" formControlName="year">
                     <option [ngValue]="null" disabled selected>Year</option>
                     @for (yr of years; track yr) {
                         <option [ngValue]="yr">Year {{ yr }}</option>
                     }
                 </select>
             </div>
          </div>

          <button
            type="submit"
            class="btn btn-primary w-100 py-3 rounded-3 fw-bold mt-2 shadow-sm"
            [disabled]="registerForm.invalid"
          >
            Create Account
          </button>
        </form>
      }

      <!-- Footer Toggle -->
      <div class="text-center mt-4 pt-3 border-top">
        <p class="text-muted small mb-0">
          {{ isLoginMode() ? "Don't have an account?" : 'Already have an account?' }}
          <a
            href="javascript:void(0)"
            class="fw-bold text-primary text-decoration-none ms-1"
            (click)="toggleMode()"
          >
            {{ isLoginMode() ? 'Sign Up' : 'Login' }}
          </a>
        </p>
        <p class="text-muted small mt-2 mb-0">
          <a
            routerLink="/admin-login"
            class="text-decoration-none"
            style="color: #8b5cf6;"
          >
            <i class="bi bi-shield-lock me-1"></i>Admin Login
          </a>
        </p>
      </div>
    </div>
  </div>
</div>
